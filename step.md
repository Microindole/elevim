

### 阶段一：打磨核心体验 (Quick Wins)


#### 1. 在窗口标题栏显示当前文件名

*   **目标**：让用户知道他们正在编辑哪个文件。
*   **思路**：
    1.  **IPC**：创建一个新的 IPC 通道，例如 `set-title`，从渲染进程发送文件名到主进程。
    2.  **主进程**：监听 `set-title`，然后调用 `mainWindow.setTitle(newTitle)`。
    3.  **渲染进程**：在打开文件 (`onFileOpen`) 或保存文件 (`saveFile` 成功返回路径) 后，调用 `window.electronAPI.setTitle()`。对于新文件，标题可以是 "Untitled"。

#### 2. 标记未保存的修改

*   **目标**：当文件被修改后，在标题栏显示一个星号 `*` (例如 `*fileName.txt`)，提醒用户保存。
*   **思路**：
    1.  **状态跟踪**：在 `renderer/index.ts` 中创建一个布尔变量，例如 `let isDirty = false;`。
    2.  **监听修改**：使用 CodeMirror 的 `EditorView.updateListener` 扩展。当检测到文档内容变化 (`update.docChanged`) 时，将 `isDirty` 设为 `true`，并更新窗口标题（加上 `*`）。
    3.  **重置状态**：当文件被**打开**或**保存**成功时，将 `isDirty` 设为 `false`，并更新窗口标题（移除 `*`）。

#### 3. 实现“新建文件”功能

*   **目标**：允许用户创建一个新的空白编辑器。
*   **思路**：
    1.  **主进程**：在 "File" 菜单中添加一个 "New File" 选项 (`CmdOrCtrl+N`)。它的 `click` 事件会向渲染进程发送一个 IPC 消息，例如 `new-file-triggered`。同时，将主进程中的 `currentFilePath` 设为 `null`。
    2.  **渲染进程**：监听 `new-file-triggered` 消息，收到后清空 CodeMirror 的内容，并重置 `isDirty` 状态和窗口标题为 "Untitled"。

---

### 阶段二：向“真正的”编辑器迈进

#### 1. 实现标签页 (Tabs) 以支持多文件编辑

*   **目标**：像 VS Code 一样，在窗口顶部显示多个标签页，允许用户在不同文件间切换。
*   **这是引入前端框架的最佳时机！**
    *   手动管理多个文件的内容、保存状态、激活状态等，用原生 JavaScript 会变得极其复杂。
    *   **我强烈建议你现在开始考虑引入 React 和 TSX**。用 React 来管理一个“已打开文件”的状态数组 (`[{ path, content, isDirty }, ...]`)，然后根据这个数组来渲染标签页和编辑器内容，会使整个逻辑变得无比清晰。
    *   你之前担心的迁移成本问题，现在可以亲自体验一下，你会发现主进程和 IPC 的代码几乎不需要改变。

#### 2. 在关闭或打开前提示保存

*   **目标**：如果当前文件有未保存的修改，在用户尝试打开新文件或关闭窗口时，弹出提示框：“您想保存更改吗？”
*   **思路**：
    1.  **渲染进程**：在执行“打开新文件”或“关闭窗口”的逻辑前，先检查 `isDirty` 状态。
    2.  **IPC**：如果 `isDirty` 为 `true`，渲染进程向主进程发送一个 IPC 消息，例如 `show-save-dialog-on-close`。
    3.  **主进程**：收到消息后，使用 `dialog.showMessageBox` 显示一个带 “保存”、“不保存”、“取消” 按钮的对话框。
    4.  **IPC**：主进程将用户的选择结果 (`'save'`, `'dont-save'`, `'cancel'`) 发回渲染进程，由渲染进程根据结果执行相应的操作（触发保存、直接打开、或什么都不做）。

---

### 阶段三：高级功能与打包

*   **实现文件树侧边栏**：在主进程中使用 Node.js 的 `fs.readdir` 递归读取目录结构，通过 IPC 发送给渲染进程来显示。
*   **实现查找与替换**：深入研究你已经安装的 `@codemirror/search` 包，它提供了构建查找/替换 UI 所需的所有功能。
*   **打包你的应用**：当你对你的编辑器感到满意时，就可以将它打包成一个真正的可执行文件 (`.exe`, `.dmg`, `.AppImage`)。
    *   **工具推荐**：**Electron Forge** 或 **Electron Builder**。它们是目前最主流的打包工具，可以帮你处理图标、签名、自动更新等所有复杂的工作。

